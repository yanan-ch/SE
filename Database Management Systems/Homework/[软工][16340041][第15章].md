#### 15.4 Solve:

**1.**（a）若惟一可用的索引是属性域 title 上的聚簇B+树索引，最佳执行计划的开销为10000 * 10% + 2500 * 10%  + 2 = 1000 + 250 + 2 = 1252；

（b）若惟一可用的索引是属性域 title上的非聚簇B+树索引，最佳执行计划的开销为10000；

（c）若惟一可用的索引是属性域 ename 上的聚簇B+树索引，最佳执行计划的开销为10000;

（d）若惟一可用的索引是属性域 address 上的聚簇B+树索引，最佳执行计划的开销为10000;

（e）若惟一可用的索引是属性域 <ename, title> 上的聚簇B+树索引，最佳执行计划的开销为10000 * 0.5 = 5000;

**2.**（a）若惟一可用的索引是属性域 title 上的聚簇B+树索引，最佳执行计划的开销为10000 * 10% + 2500 * 10%  + 2 = 1000 + 250 + 2 = 1252；

（b）若惟一可用的索引是属性域 dname上的聚簇B+树索引，最佳执行计划的开销为1002 + 250 = 1252；

（c）若惟一可用的索引是属性域 <title, dname> 上的聚簇B+树索引，最佳执行计划的开销为10000 * 5% + 5000 * 5%  + 2 = 752;

（d）若惟一可用的索引是属性域 <title, ename> 上的聚簇B+树索引，最佳执行计划的开销为2 + 10000 * 10% + 5000 * 10% = 1502 ;

（e）若惟一可用的索引是属性域 <dname, title, ename> 上的聚簇B+树索引，最佳执行计划的开销为2 + 10000 * 5% * 0.75 = 402;

（f）若惟一可用的索引是属性域 <dname, title, dname> 上的聚簇B+树索引，最佳执行计划的开销为10000 * 0.75 = 7500;

**3.**（a）若惟一可用的索引是属性域 title 上的聚簇B+树索引，最佳执行计划的开销为10000 * 0.25 = 2500；

（b）若惟一可用的索引是属性域 title上的非聚簇B+树索引，最佳执行计划的开销为2500；

（c）若惟一可用的索引是属性域 ename 上的聚簇B+树索引，最佳执行计划的开销为10000 + 3 * 2 * 2500 = 27500;

（d）若惟一可用的索引是属性域 <ename, title> 上的聚簇B+树索引，最佳执行计划的开销为5000 + 3 * 2 * 2500 = 22500;

（e）若惟一可用的索引是属性域 <title, ename> 上的聚簇B+树索引，最佳执行计划的开销为10000 * 0.5 = 5000;

**4.**（a）若惟一可用的索引是属性域 title 上的聚簇B+树索引，最佳执行计划的开销为10000 ；如果（在任意查询码上）还有一个索引dname，执行计划的开销会进一步减少，为1500；

（b）若惟一可用的索引是属性域 title上的非聚簇B+树索引，最佳执行计划的开销为10000 + 2 * 2 * 10000 * 0.25 = 20000 ；

（c）若惟一可用的索引是属性域 dname 上的聚簇B+树索引，最佳执行计划的开销为2500 * 10% + 10000 * 10% + 10000 * 10% * 0.25 + 3 * 250 = 2250；

（d）若惟一可用的索引是属性域 <dname, title>  上的聚簇B+树索引，最佳执行计划的开销为5000 * 10% + 10000 * 10% * 0.25 + 3 * 250 = 1500 ;

（e）若惟一可用的索引是属性域 <title, dname> 上的聚簇B+树索引，最佳执行计划的开销为10000 * 0.5 = 5000;


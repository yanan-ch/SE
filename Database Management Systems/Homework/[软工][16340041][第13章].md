#### 13.3 Solve:

（1) 进行第一遍处理后，生成113个有序的子文件，前112个子文件每个有4页，第113个子文件只有2页：

$$(512-12) / 48 = 10.417$$, 一个数据页有10个记录,

$$4500 / 10 = 450$$, 总计需要450页，

$$450 / 4 = 113$$, 因此生成113个文件。

（2)对文件排序需要处理6遍：

$$\log_3113 + 1 = 6$$

（3)文件排序总的I/O开销是5400：

$$2 * 450 * 6 = 5400$$

（4)只用4个缓冲区页，处理2遍，可以排序的最大文件所包含的元组数目为120：

页数为3 * 4 = 12， 元组数目为12 * 10 = 120；

如果有257个可用的缓冲区页，则元组数目应为657920：

页数为256 * 257 = 65792， 元组数目为65792 * 10 = 657920；

（5) 

- 索引采用第一种数据项格式时，开销为600；
- 索引采用第二种数据项格式，并且为非聚簇索引时，最坏情况下开销为4650；